df <- read.csv(paste0(gitHubPath, 'data\\WA_Marketing-Campaign.csv'))
temp = df$SalesInThousands[df$Promotion == 3 & df$MarketSize == "Large"]
df$SalesInThousands[df$Promotion == 3 & df$MarketSize == "Large"] = temp -
rnorm(length(temp), 1.5, 30)
min(df$SalesInThousands)
df$SalesInThousands[df$SalesInThousands<0] <- rnorm(sum(df$SalesInThousands<0),
10, 3)
min(df$SalesInThousands)
df$Promotion = as.factor(df$Promotion)
df %>% ggplot(aes(y = SalesInThousands, color = Promotion)) +
geom_boxplot(linewidth = 2)+
myTheme + brightCol + brightFil+
theme(axis.text.x = element_blank()) +
facet_grid(~MarketSize)
df %>% ggplot(aes(y = SalesInThousands, color = MarketSize)) +
geom_boxplot(linewidth = 2)+
myTheme + brightCol + brightFil+
theme(axis.text.x = element_blank())
df %>% ggplot(aes(x = AgeOfStore, y = SalesInThousands, color = MarketSize)) +
geom_jitter() +
myTheme + brightCol + brightFil
df %>% ggplot(aes(x = week, y = SalesInThousands,
group = LocationID, color = LocationID)) +
geom_line(alpha = .5) +
myTheme +
scale_color_gradient2(low = "green", mid = "white", high = "magenta",
midpoint = 500)
df<- df %>% group_by(LocationID) %>%
summarize(SalesInThousands = mean(SalesInThousands),
across(everything(), ~ first(.), .names = "{.col}"))
# Chunk 3: sample size
length(unique(df$LocationID))
names(df)
df %>% ggplot(aes(x = week, y = SalesInThousands,
group = LocationID, color = LocationID)) +
geom_line(alpha = .5) +
myTheme +
scale_color_gradient2(low = "green", mid = "white", high = "magenta",
midpoint = 500)
#is there much variability week to week?
df %>% group_by(week) %>% summarize(weeklyMean = mean(SalesInThousands),
se = sd(SalesInThousands)/sqrt(n()))%>%
ggplot(aes(x = week, y = weeklyMean, group = 1)) +
geom_line(linewidth = 3, color = 'green') +            # Linegraph
geom_point(size = 3, color = 'green') +                # Points for means
geom_errorbar(aes(ymin = weeklyMean - se,   # Lower bound of error
ymax = weeklyMean + se),  # Upper bound of error
width = 0.2, color = 'green') +          # Width of error bars
myTheme
df<- df %>% group_by(LocationID) %>%
summarize(SalesInThousands = mean(SalesInThousands),
across(everything(), ~ first(.), .names = "{.col}"))
group_means <- df %>%
group_by(Promotion) %>%
summarise(
mean_y = mean(SalesInThousands, na.rm = TRUE),
xmin = as.numeric(Promotion[1])-.5,
xmax = as.numeric(Promotion[1])+.5
)
# Now plot
ggplot(df, aes(x = as.numeric(Promotion), y = SalesInThousands, color = Promotion)) +
geom_jitter() +
geom_segment(data = group_means,
aes(x = xmin, xend = xmax, y = mean_y, yend = mean_y),
color = "red", linetype = "dashed", inherit.aes = FALSE) +
geom_hline(yintercept = mean(df$SalesInThousands),
color = 'blue', linewidth = 2)+
myTheme + brightCol +
xlab('Promotion') +
theme(legend.position = 'none')
test = anova(lm(SalesInThousands ~ Promotion, data = df))
TukeyHSD(test)
test = aov(lm(SalesInThousands ~ Promotion, data = df))
TukeyHSD(test)
anova(lm(SalesInThousands ~ Promotion, data = df))
# Chunk 1
# Set rendering parameters
knitr::opts_chunk$set(message = FALSE, warning = FALSE)
gitHubPath = 'C:\\Users\\Adam\\Documents\\GitHub\\MasterStatsUsingR\\'
library(tidyverse) # data manipulation and visualization
source(paste0(gitHubPath, 'courseTheme.R'))
# Chunk 2: data
df <- read.csv(paste0(gitHubPath, 'data\\WA_Marketing-Campaign.csv'))
df$Promotion <- as.factor(df$Promotion)
#average over weeks within store
df<- df %>% group_by(LocationID) %>%
summarize(SalesInThousands = mean(SalesInThousands),
across(everything(), ~ first(.), .names = "{.col}"))
anova(lm(SalesInThousands ~ Promotion, data = df))
df %>% ggplot(aes(y = SalesInThousands, color = Promotion)) +
geom_boxplot(linewidth = 2)+
myTheme + brightCol + brightFil+
theme(axis.text.x = element_blank())
test = anova(lm(SalesInThousands ~ Promotion, data = df))
test
MSerror = test$`Mean Sq`[2]
df %>% group_by(Promotion) %>%
summarize(groupn = n(),
groupMean = mean(SalesInThousands))
sumVals = df %>% group_by(Promotion) %>%
summarize(groupn = n(),
groupMean = mean(SalesInThousands))
sumVals = df %>% group_by(Promotion) %>%
summarize(n = n(),
Mean = mean(SalesInThousands))
#promotion 1 v. 2
qVal = abs(sumVals$Mean[1] - sumVals$Mean[2]) /
((MSerror/sumVals$n[1] + MSerror/sumVals$n[2]) / 2)
df = nrow(df) - 3
dferror = nrow(df) - 3
pval = ptukey(qVal, 3, dferror)
dferror = nrow(df) - 3
nrow(df)
nrow(df)
# Chunk 1
# Set rendering parameters
knitr::opts_chunk$set(message = FALSE, warning = FALSE)
gitHubPath = 'C:\\Users\\Adam\\Documents\\GitHub\\MasterStatsUsingR\\'
library(tidyverse) # data manipulation and visualization
source(paste0(gitHubPath, 'courseTheme.R'))
# Chunk 2: data
df <- read.csv(paste0(gitHubPath, 'data\\WA_Marketing-Campaign.csv'))
df$Promotion <- as.factor(df$Promotion)
#average over weeks within store
df<- df %>% group_by(LocationID) %>%
summarize(SalesInThousands = mean(SalesInThousands),
across(everything(), ~ first(.), .names = "{.col}"))
df %>% ggplot(aes(y = SalesInThousands, color = Promotion)) +
geom_boxplot(linewidth = 2)+
myTheme + brightCol + brightFil+
theme(axis.text.x = element_blank())
dferror = nrow(df) - 3
#promotion 1 v. 2
qVal = abs(sumVals$Mean[1] - sumVals$Mean[2]) /
((MSerror/sumVals$n[1] + MSerror/sumVals$n[2]) / 2)
pval = ptukey(qVal, 3, dferror)
sumVals
pval
pval = 1 - ptukey(qVal, 3, dferror)
pval
test = anova(lm(SalesInThousands ~ Promotion, data = df))
test
#FORMULA: Q = abs(mean1 - mean2) / [(MSerror / n1 + MSerror / n2) / 2]
#get all the necessary values:
MSerror = test$`Mean Sq`[2]
sumVals = df %>% group_by(Promotion) %>%
summarize(n = n(),
Mean = mean(SalesInThousands))
dferror = nrow(df) - 3
#promotion 1 v. 2
qVal = abs(sumVals$Mean[1] - sumVals$Mean[2]) /
((MSerror/sumVals$n[1] + MSerror/sumVals$n[2]) / 2)
pval = 1 - ptukey(qVal, 3, dferror)
pval
#promotion 1 v. 2
qVal = abs(sumVals$Mean[1] - sumVals$Mean[2]) /
((MSerror/sumVals$n[1] + MSerror/sumVals$n[2]))
pval = 1 - ptukey(qVal, 3, dferror)
pval
TukeyHSD(aov(lm(SalesInThousands ~ Promotion, data = df))
)
test = anova(lm(SalesInThousands ~ Promotion, data = df))
test
#FORMULA: Q = abs(mean1 - mean2) / [(MSerror / n1 + MSerror / n2) / 2]
#get all the necessary values:
MSerror = test$`Mean Sq`[2]
sumVals = df %>% group_by(Promotion) %>%
summarize(n = n(),
Mean = mean(SalesInThousands))
dferror = nrow(df) - 3
#promotion 1 v. 2
qVal = abs(sumVals$Mean[1] - sumVals$Mean[2]) /
((MSerror/sumVals$n[1] + MSerror/sumVals$n[2]))
pval = 1 - ptukey(qVal, 3, dferror)
pval
TukeyHSD(aov(lm(SalesInThousands ~ Promotion, data = df)))
#promotion 1 v. 2
qVal = abs(sumVals$Mean[1] - sumVals$Mean[2]) /
sqrt(((MSerror/sumVals$n[1] + MSerror/sumVals$n[2])))
pval = 1 - ptukey(qVal, 3, dferror)
pval
#promotion 1 v. 2
qVal = abs(sumVals$Mean[1] - sumVals$Mean[2]) /
sqrt(((MSerror/sumVals$n[1] + MSerror/sumVals$n[2]))/2)
pval = 1 - ptukey(qVal, 3, dferror)
pval
cat('the adjusted p-value for the difference is: ', round(pval, 6))
#remember that confidence intervals are the middle 1-alpha proportion of the
#distribution
qtukey(.975, 3, dferror)
critQ = qtukey(.975, 3, dferror)
#standard error is just the denominator from the tukey equation:
se =  sqrt(((MSerror/sumVals$n[1] + MSerror/sumVals$n[2]))/2)
critQ*se
abs(sumVals$Mean[1] - sumVAls$Mean[2]) + critQ*se
abs(sumVals$Mean[1] - sumVals$Mean[2]) + critQ*se
TukeyHSD(aov(lm(SalesInThousands ~ Promotion, data = df)))
abs(sumVals$Mean[1] - sumVals$Mean[2]) + (critQ/sqrt(2))*se
critQ = qtukey(.95, 3, dferror)
#standard error is just the denominator from the tukey equation:
se =  sqrt(((MSerror/sumVals$n[1] + MSerror/sumVals$n[2]))/2)
abs(sumVals$Mean[1] - sumVals$Mean[2]) + critQ*se
abs(sumVals$Mean[1] - sumVals$Mean[2]) + (critQ/sqrt(2))*se
TukeyHSD(aov(lm(SalesInThousands ~ Promotion, data = df)))
critQ = qtukey(.95, 3, dferror)
#standard error is just the denominator from the tukey equation:
se =  sqrt(((MSerror/sumVals$n[1] + MSerror/sumVals$n[2]))/2)
abs(sumVals$Mean[1] - sumVals$Mean[2]) + critQ*se
abs(sumVals$Mean[1] - sumVals$Mean[2]) + (critQ/sqrt(2))*se
qVal = abs(sumVals$Mean[1] - sumVals$Mean[2]) /
sqrt(((MSerror/sumVals$n[1] + MSerror/sumVals$n[2]))/2)
pval = 1 - ptukey(qVal, 3, dferror)
cat('the adjusted p-value for the difference is: ', round(pval, 6))
TukeyHSD(aov(lm(SalesInThousands ~ Promotion, data = df)))
qVal = abs(sumVals$Mean[1] - sumVals$Mean[2]) /
sqrt(((MSerror/sumVals$n[1] + MSerror/sumVals$n[2])))
pval = 1 - ptukey(qVal, 3, dferror)
cat('the adjusted p-value without dividing by 2 for the difference is: ', round(pval, 6))
#promotion 1 v. 2
qVal = abs(sumVals$Mean[1] - sumVals$Mean[2]) /
sqrt(((MSerror/sumVals$n[1] + MSerror/sumVals$n[2]))/2)
pval = 1 - ptukey(qVal, 3, dferror)
cat('the adjusted p-value without dividing by 2 for the difference is: ', round(pval, 6))
TukeyHSD(aov(lm(SalesInThousands ~ Promotion, data = df)))
plot(TukeyHSD(aov(lm(SalesInThousands ~ Promotion, data = df))))
critQ = qtukey(.95, 3, dferror)
#standard error is just the denominator from the tukey equation:
se =  sqrt(((MSerror/sumVals$n[1] + MSerror/sumVals$n[2]))/2)
abs(sumVals$Mean[1] - sumVals$Mean[2]) + critQ*se
abs(sumVals$Mean[1] - sumVals$Mean[2]) + (critQ/sqrt(2))*se
critQ = qtukey(.95, 3, dferror)
#standard error is just the denominator from the tukey equation:
se =  sqrt(((MSerror/sumVals$n[1] + MSerror/sumVals$n[2]))/2)
abs(sumVals$Mean[1] - sumVals$Mean[2]) + critQ*se
TukeyHSD(aov(lm(SalesInThousands ~ Promotion, data = df)))
critQ = qtukey(.95, 3, dferror)
#standard error is just the denominator from the tukey equation:
se =  sqrt(((MSerror/sumVals$n[1] + MSerror/sumVals$n[2]))/2)
abs(sumVals$Mean[1] - sumVals$Mean[2]) + critQ*se
#think critically: why not .975 like we've used for 2-tailed intervals before?
critQ = qtukey(.95, 3, dferror)
#standard error is just the denominator from the tukey equation:
se =  sqrt(((MSerror/sumVals$n[1] + MSerror/sumVals$n[2]))/2)
topBound = sumVals$Mean[1] - sumVals$Mean[2] + critQ*se
lowBound = sumVals$Mean[1] - sumVals$Mean[2] + critQ*se
cat('the 95% confidence interval for the difference between Promotion 1 and 2: ',
round(lowBound, 3), ' to ', round(topBound, 3))
topBound = sumVals$Mean[1] - sumVals$Mean[2] + critQ*se
lowBound = sumVals$Mean[1] - sumVals$Mean[2] - critQ*se
cat('the 95% confidence interval for the difference between Promotion 1 and 2: ',
round(lowBound, 3), ' to ', round(topBound, 3))
TukeyHSD(aov(lm(SalesInThousands ~ Promotion, data = df)))
cat('diff: ', round(sumVals$Mean[1] - sumVals$Mean[2], 3),
'\n lwr: ', round(lowBound, 3),
'\n upr: ', round(topBound, 3))
cat('diff: ', round(sumVals$Mean[1] - sumVals$Mean[2], 3),
'\n lwr: ', round(lowBound, 3),
'\n upr: ', round(topBound, 3),
'\n p adj: ', round(pval, 3))
cat('diff: ', round(sumVals$Mean[1] - sumVals$Mean[2], 3),
'\n lwr: ', round(lowBound, 3),
'\n upr: ', round(topBound, 3),
'\n p adj: ', round(pval, 6))
TukeyHSD(aov(lm(SalesInThousands ~ Promotion, data = df)))
df <- read.csv(paste0(gitHubPath, 'data\\WA_Marketing-Campaign.csv'))
temp = df$SalesInThousands[df$Promotion == 3 & df$MarketSize == "Large"]
df$SalesInThousands[df$Promotion == 3 & df$MarketSize == "Large"] = temp -
rnorm(length(temp), 1.5, 30)
min(df$SalesInThousands)
df$SalesInThousands[df$SalesInThousands<0] <- rnorm(sum(df$SalesInThousands<0),
10, 3)
min(df$SalesInThousands)
df$Promotion = as.factor(df$Promotion)
df %>% ggplot(aes(y = SalesInThousands, color = Promotion)) +
geom_boxplot(linewidth = 2)+
myTheme + brightCol + brightFil+
theme(axis.text.x = element_blank()) +
facet_grid(~MarketSize)
df %>% ggplot(aes(y = SalesInThousands, color = MarketSize)) +
geom_boxplot(linewidth = 2)+
myTheme + brightCol + brightFil+
theme(axis.text.x = element_blank())
df %>% ggplot(aes(x = AgeOfStore, y = SalesInThousands, color = MarketSize)) +
geom_jitter() +
myTheme + brightCol + brightFil
df %>% ggplot(aes(x = week, y = SalesInThousands,
group = LocationID, color = LocationID)) +
geom_line(alpha = .5) +
myTheme +
scale_color_gradient2(low = "green", mid = "white", high = "magenta",
midpoint = 500)
df<- df %>% group_by(LocationID) %>%
summarize(SalesInThousands = mean(SalesInThousands),
across(everything(), ~ first(.), .names = "{.col}"))
length(unique(df$LocationID))
names(df)
df %>% ggplot(aes(x = week, y = SalesInThousands,
group = LocationID, color = LocationID)) +
geom_line(alpha = .5) +
myTheme +
scale_color_gradient2(low = "green", mid = "white", high = "magenta",
midpoint = 500)
#is there much variability week to week?
df %>% group_by(week) %>% summarize(weeklyMean = mean(SalesInThousands),
se = sd(SalesInThousands)/sqrt(n()))%>%
ggplot(aes(x = week, y = weeklyMean, group = 1)) +
geom_line(linewidth = 3, color = 'green') +            # Linegraph
geom_point(size = 3, color = 'green') +                # Points for means
geom_errorbar(aes(ymin = weeklyMean - se,   # Lower bound of error
ymax = weeklyMean + se),  # Upper bound of error
width = 0.2, color = 'green') +          # Width of error bars
myTheme
df<- df %>% group_by(LocationID) %>%
summarize(SalesInThousands = mean(SalesInThousands),
across(everything(), ~ first(.), .names = "{.col}"))
group_means <- df %>%
group_by(Promotion) %>%
summarise(
mean_y = mean(SalesInThousands, na.rm = TRUE),
xmin = as.numeric(Promotion[1])-.5,
xmax = as.numeric(Promotion[1])+.5
)
# Now plot
ggplot(df, aes(x = as.numeric(Promotion), y = SalesInThousands, color = Promotion)) +
geom_jitter() +
geom_segment(data = group_means,
aes(x = xmin, xend = xmax, y = mean_y, yend = mean_y),
color = "red", linetype = "dashed", inherit.aes = FALSE) +
geom_hline(yintercept = mean(df$SalesInThousands),
color = 'blue', linewidth = 2)+
myTheme + brightCol +
xlab('Promotion') +
theme(legend.position = 'none')
df %>% ggplot(aes(x = AgeOfStore, y = SalesInThousands, color = MarketSize)) +
geom_jitter() +
myTheme + brightCol + brightFil
df %>% ggplot(aes(y = SalesInThousands, color = MarketSize)) +
geom_boxplot(linewidth = 2)+
myTheme + brightCol + brightFil+
theme(axis.text.x = element_blank())
df %>% ggplot(aes(y = SalesInThousands, color = Promotion)) +
geom_boxplot(linewidth = 2)+
myTheme + brightCol + brightFil+
theme(axis.text.x = element_blank()) +
facet_grid(.~MarketSize)
df %>% ggplot(aes(x = as.numeric(Promotion),
y = SalesInThousands,
color = Promotion)) +
geom_jitter()+
myTheme + brightCol + brightFil+
theme(axis.text.x = element_blank()) +
facet_grid(.~MarketSize)
df %>% ggplot(aes(x = as.numeric(Promotion),
y = SalesInThousands,
color = Promotion)) +
geom_jitter()+
geom_boxplot() +
myTheme + brightCol + brightFil+
theme(axis.text.x = element_blank()) +
facet_grid(.~MarketSize)
df %>% ggplot(aes(x = as.numeric(Promotion),
y = SalesInThousands,
color = Promotion)) +
geom_jitter()+
geom_boxplot(fill = NA) +
myTheme + brightCol + brightFil+
theme(axis.text.x = element_blank()) +
facet_grid(.~MarketSize)
df %>% ggplot(aes(x = as.numeric(Promotion),
y = SalesInThousands,
color = Promotion)) +
geom_jitter()+
stat_summary(fun = mean, geom = "crossbar",
width = 0.5, fatten = 2) +
myTheme + brightCol + brightFil+
theme(axis.text.x = element_blank()) +
facet_grid(.~MarketSize)
df %>% ggplot(aes(x = as.numeric(Promotion),
y = SalesInThousands,
color = Promotion)) +
geom_jitter()+
geom_hline(yintercept = mean(Df$SalesInThousands), color = 'red', linetype= 'dashed') +
stat_summary(fun = mean, geom = "crossbar",
width = 0.5, fatten = 2) +
myTheme + brightCol + brightFil+
theme(axis.text.x = element_blank()) +
facet_grid(.~MarketSize)
df %>% ggplot(aes(x = as.numeric(Promotion),
y = SalesInThousands,
color = Promotion)) +
geom_jitter()+
geom_hline(yintercept = mean(df$SalesInThousands), color = 'red', linetype= 'dashed') +
stat_summary(fun = mean, geom = "crossbar",
width = 0.5, fatten = 2) +
myTheme + brightCol + brightFil+
theme(axis.text.x = element_blank()) +
facet_grid(.~MarketSize)
# Chunk 1
# Set rendering parameters
knitr::opts_chunk$set(message = FALSE, warning = FALSE)
gitHubPath <- file.path(path.expand("~"), "GitHub",
"MasterStatsUsingR")
library(tidyverse) # data manipulation and visualization
source(paste0(gitHubPath, 'courseTheme.R'))
source(file.path(gitHubPath, 'courseTheme.R'))
df <- read.csv(file.path(gitHubPath, 'data',
'WA_Marketing-Campaign.csv'))
df$Promotion <- as.factor(df$Promotion)
#average over weeks within store
df<- df %>% group_by(LocationID) %>%
summarize(SalesInThousands = mean(SalesInThousands),
across(everything(), ~ first(.)))
dfCut = df %>% filter(Promotion != 3)
sumA = anova(lm(SalesInThousands ~ Promotion, data = dfCut))
sumT = t.test(dfCut$SalesInThousands[dfCut$Promotion==1],
dfCut$SalesInThousands[dfCut$Promotion==2], var.equal = T)
cat('the difference between promotion 1 and 2 yields a t-value of: ',
round(sumT$statistic, 2), ' \nThis value squared is: ',
round(sumT$statistic^2, 2), ' \nThe F-value is: ',
round(sumA$`F value`[1],2))
# Set rendering parameters
knitr::opts_chunk$set(message = FALSE, warning = FALSE)
gitHubPath <- file.path(path.expand("~"), "GitHub",
"MasterStatsUsingR")
library(tidyverse) # data manipulation and visualization
source(file.path(gitHubPath, 'courseTheme.R'))
df <- read.csv(file.path(gitHubPath, 'data',
'WA_Marketing-Campaign.csv'))
df$Promotion <- as.factor(df$Promotion)
#average over weeks within store
df<- df %>% group_by(LocationID) %>%
summarize(SalesInThousands = mean(SalesInThousands),
across(everything(), ~ first(.)))
dfCut = df %>% filter(Promotion != 3)
sumA = anova(lm(SalesInThousands ~ Promotion, data = dfCut))
sumT = t.test(dfCut$SalesInThousands[dfCut$Promotion==1],
dfCut$SalesInThousands[dfCut$Promotion==2], var.equal = T)
sumA
sumT
cat('the difference between promotion 1 and 2 yields a t-value of: ',
round(sumT$statistic, 2), ' \nThis value squared is: ',
round(sumT$statistic^2, 2), ' \nThe F-value is: ',
round(sumA$`F value`[1],2))
sumT$statistic
View(sumA)
View(sumA)
cat('the difference between promotion 1 and 2 yields a t-value of: ',
round(sumT$statistic, 2), ' \nThis value squared is: ',
round(sumT$statistic^2, 2), ' \nThe F-value is: ',
round(sumA$`F value`[1],2))
# Chunk 1
# Set rendering parameters
knitr::opts_chunk$set(message = FALSE, warning = FALSE)
gitHubPath <- file.path(path.expand("~"), "GitHub",
"MasterStatsUsingR")
library(tidyverse) # data manipulation and visualization
source(file.path(gitHubPath, 'courseTheme.R'))
# Chunk 2: data
df <- read.csv(file.path(gitHubPath, 'data',
'WA_Marketing-Campaign.csv'))
df$Promotion <- as.factor(df$Promotion)
#average over weeks within store
df<- df %>% group_by(LocationID) %>%
summarize(SalesInThousands = mean(SalesInThousands),
across(everything(), ~ first(.)))
test = lm(SalesInThousands ~ Promotion, data = df)
df$residuals = test$residuals
qVals = seq(.01, 1, .01)
qqVals = data.frame('empirical' = quantile(df$residuals, qVals),
'norm'      = qnorm(qVals, mean = mean(df$residuals),
sd = sd(df$residuals)),
'qVals'     = qVals)
ggplot(qqVals, aes(x = norm, y = empirical, color = qVals)) +
geom_point(size = 3) +
geom_abline(slope = 1, intercept = 0)
df$dummy = as.factor(1)
ggplot(df, aes(x = residuals, fill = dummy))+
geom_histogram() + brightCol + myTheme +
theme(legend.position = 'none')
ggplot(df, aes(x = residuals, fill = dummy))+
geom_histogram() + brightFil + myTheme +
theme(legend.position = 'none')
# Set rendering parameters
knitr::opts_chunk$set(message = FALSE, warning = FALSE)
gitHubPath <- file.path(path.expand("~"), "GitHub",
"MasterStatsUsingR")
library(tidyverse) # data manipulation and visualization
source(file.path(gitHubPath, 'courseTheme.R'))
df <- read.csv(file.path(gitHubPath, 'data',
'WA_Marketing-Campaign.csv'))
df$Promotion <- as.factor(df$Promotion)
#average over weeks within store
df<- df %>% group_by(LocationID) %>%
summarize(SalesInThousands = mean(SalesInThousands),
across(everything(), ~ first(.)))
test = lm(SalesInThousands ~ Promotion, data = df)
View(test)
df$residuals = test$residuals
qVals = seq(.01, 1, .01)
quantile(df$residuals, qVals)
qqVals = data.frame('empirical' = quantile(df$residuals, qVals),
'norm'    = qnorm(qVals,
mean = mean(df$residuals),
sd = sd(df$residuals)),
'qVals'     = qVals)
ggplot(qqVals, aes(x = norm, y = empirical, color = qVals)) +
geom_point(size = 3) +
geom_abline(slope = 1, intercept = 0)
df$dummy = as.factor(1)
ggplot(df, aes(x = residuals, fill = dummy))+
geom_histogram() + brightFil + myTheme +
theme(legend.position = 'none')
